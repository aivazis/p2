# -*- Makefile -*-
#
# michael a.g. aïvázis <michael.aivazis@para-sim.com>
# (c) 1998-2019 all rights reserved


# the libp2 test suite
p2.lib.tests.stem := pyre.lib
p2.lib.tests.prerequisites := p2.lib pyre
p2.lib.tests.extern := p2.lib pyre

# c++ compiler arguments
p2.lib.tests.c++.defines := PYRE_CORE
p2.lib.tests.c++.flags += -Wall $($(compiler.c++).std.c++17)


# global clean up
tests.pyre.lib.memory.clean += filemap.dat map.dat
tests.pyre.lib.grid.clean += grid_mmap.data


# test case configuration
# the {pyre::memory} tests must be executed in a specific order
tests.pyre.lib.memory.filemap_write.pre := tests.pyre.lib.memory.filemap_create
tests.pyre.lib.memory.filemap_read.pre := tests.pyre.lib.memory.filemap_write

tests.pyre.lib.memory.map_write.pre := tests.pyre.lib.memory.map_create
tests.pyre.lib.memory.map_read.pre := tests.pyre.lib.memory.map_write
tests.pyre.lib.memory.map_oob.pre := tests.pyre.lib.memory.map_write
tests.pyre.lib.memory.constmap_read.pre := tests.pyre.lib.memory.map_write
tests.pyre.lib.memory.constmap_oob.pre := tests.pyre.lib.memory.map_write

# grid tests with special needs
tests.pyre.lib.grid.grid_mmap_set.pre := tests.pyre.lib.grid.grid_mmap_sanity
tests.pyre.lib.grid.grid_mmap_get.pre := tests.pyre.lib.grid.grid_mmap_set


# end of file
